"""empty message

Revision ID: 4c6286049a35
Revises: 
Create Date: 2019-01-30 10:46:17.586997

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '4c6286049a35'
down_revision = None
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint('group_owner_user_fkey', 'group', type_='foreignkey')
    op.create_foreign_key(None, 'group', 'users', ['owner_user'], ['user_id'], source_schema='public', referent_schema='public')
    op.drop_constraint('issue_issue_user_fkey', 'issue', type_='foreignkey')
    op.create_foreign_key(None, 'issue', 'users', ['issue_user'], ['user_id'], source_schema='public', referent_schema='public')
    op.drop_constraint('journal_briefs_journalized_id_fkey', 'journal_briefs', type_='foreignkey')
    op.create_foreign_key(None, 'journal_briefs', 'journals', ['journalized_id'], ['journalized_id'], source_schema='public', referent_schema='public')
    op.drop_constraint('journal_details_j_brief_id_fkey', 'journal_details', type_='foreignkey')
    op.create_foreign_key(None, 'journal_details', 'journal_briefs', ['j_brief_id'], ['j_brief_id'], source_schema='public', referent_schema='public')
    op.drop_constraint('replay_issue_id_fkey', 'replay', type_='foreignkey')
    op.drop_constraint('replay_issue_user_fkey', 'replay', type_='foreignkey')
    op.create_foreign_key(None, 'replay', 'issue', ['issue_id'], ['issue_id'], source_schema='public', referent_schema='public')
    op.create_foreign_key(None, 'replay', 'users', ['issue_user'], ['user_id'], source_schema='public', referent_schema='public')
    op.drop_constraint('role_permission_perm_id_fkey', 'role_permission', type_='foreignkey')
    op.drop_constraint('role_permission_role_id_fkey', 'role_permission', type_='foreignkey')
    op.create_foreign_key(None, 'role_permission', 'permission', ['perm_id'], ['permission_id'], referent_schema='public')
    op.create_foreign_key(None, 'role_permission', 'roles', ['role_id'], ['role_id'], referent_schema='public')
    op.create_index('public_user_role_project_group_user_id_idx', 'user_role', ['proj_id', 'group_id', 'user_id'], unique=True, schema='public')
    op.drop_constraint('user_role_user_id_fkey', 'user_role', type_='foreignkey')
    op.drop_constraint('user_role_role_id_fkey', 'user_role', type_='foreignkey')
    op.drop_constraint('user_role_group_id_fkey', 'user_role', type_='foreignkey')
    op.drop_constraint('user_role_proj_id_fkey', 'user_role', type_='foreignkey')
    op.create_foreign_key(None, 'user_role', 'users', ['user_id'], ['user_id'], source_schema='public', referent_schema='public')
    op.create_foreign_key(None, 'user_role', 'roles', ['role_id'], ['role_id'], source_schema='public', referent_schema='public')
    op.create_foreign_key(None, 'user_role', 'group', ['group_id'], ['group_id'], source_schema='public', referent_schema='public')
    op.create_foreign_key(None, 'user_role', 'projects', ['proj_id'], ['proj_id'], source_schema='public', referent_schema='func')
    op.drop_constraint('func_group_group_id_fkey', 'func_group', schema='func', type_='foreignkey')
    op.create_foreign_key(None, 'func_group', 'group', ['group_id'], ['group_id'], source_schema='func', referent_schema='public')
    op.create_index('func_func_man_day_task_option_group_version_id_idx', 'func_man_day', ['task_id', 'group_id', 'option_id', 'version'], unique=True, schema='func')
    op.drop_index('func_func_man_day_task_id_group_id_idx', table_name='func_man_day', schema='func')
    op.drop_constraint('func_man_day_create_user_fkey', 'func_man_day', schema='func', type_='foreignkey')
    op.drop_constraint('func_man_day_update_user_fkey', 'func_man_day', schema='func', type_='foreignkey')
    op.drop_constraint('func_man_day_assin_to_fkey', 'func_man_day', schema='func', type_='foreignkey')
    op.drop_constraint('func_man_day_group_id_fkey', 'func_man_day', schema='func', type_='foreignkey')
    op.create_foreign_key(None, 'func_man_day', 'users', ['assin_to'], ['user_id'], source_schema='func', referent_schema='public')
    op.create_foreign_key(None, 'func_man_day', 'group', ['group_id'], ['group_id'], source_schema='func', referent_schema='public')
    op.create_foreign_key(None, 'func_man_day', 'users', ['update_user'], ['user_id'], source_schema='func', referent_schema='public')
    op.create_foreign_key(None, 'func_man_day', 'users', ['create_user'], ['user_id'], source_schema='func', referent_schema='public')
    op.create_index(op.f('ix_func_functions_category_id'), 'functions', ['category_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_functions_create_user'), 'functions', ['create_user'], unique=False, schema='func')
    op.create_index(op.f('ix_func_functions_quotation_id'), 'functions', ['quotation_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_functions_update_user'), 'functions', ['update_user'], unique=False, schema='func')
    op.drop_constraint('functions_create_user_fkey', 'functions', schema='func', type_='foreignkey')
    op.drop_constraint('functions_update_user_fkey', 'functions', schema='func', type_='foreignkey')
    op.create_foreign_key(None, 'functions', 'users', ['create_user'], ['user_id'], source_schema='func', referent_schema='public')
    op.create_foreign_key(None, 'functions', 'users', ['update_user'], ['user_id'], source_schema='func', referent_schema='public')
    op.create_index(op.f('ix_func_option_value_option_id'), 'option_value', ['option_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_options_proj_id'), 'options', ['proj_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_options_quotation_id'), 'options', ['quotation_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_preconditions_proj_id'), 'preconditions', ['proj_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_preconditions_quotation_id'), 'preconditions', ['quotation_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_projects_commit_user'), 'projects', ['commit_user'], unique=False, schema='func')
    op.create_index(op.f('ix_func_projects_inside_name'), 'projects', ['inside_name'], unique=False, schema='func')
    op.create_index(op.f('ix_func_projects_proj_state'), 'projects', ['proj_state'], unique=False, schema='func')
    op.create_index(op.f('ix_func_projects_proj_type'), 'projects', ['proj_type'], unique=False, schema='func')
    op.drop_constraint('projects_commit_user_fkey', 'projects', schema='func', type_='foreignkey')
    op.create_foreign_key(None, 'projects', 'users', ['commit_user'], ['user_id'], source_schema='func', referent_schema='public')
    op.add_column('quotations', sa.Column('quotation_ver', sa.Integer(), nullable=True), schema='func')
    op.create_index(op.f('ix_func_quotations_create_user'), 'quotations', ['create_user'], unique=False, schema='func')
    op.create_index(op.f('ix_func_quotations_parent_quotation_id'), 'quotations', ['parent_quotation_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_quotations_proj_id'), 'quotations', ['proj_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_quotations_quotation_ver'), 'quotations', ['quotation_ver'], unique=False, schema='func')
    op.create_index(op.f('ix_func_quotations_status'), 'quotations', ['status'], unique=False, schema='func')
    op.create_index(op.f('ix_func_quotations_update_user'), 'quotations', ['update_user'], unique=False, schema='func')
    op.drop_constraint('quotations_update_user_fkey', 'quotations', schema='func', type_='foreignkey')
    op.drop_constraint('quotations_create_user_fkey', 'quotations', schema='func', type_='foreignkey')
    op.create_foreign_key(None, 'quotations', 'users', ['update_user'], ['user_id'], source_schema='func', referent_schema='public')
    op.create_foreign_key(None, 'quotations', 'users', ['create_user'], ['user_id'], source_schema='func', referent_schema='public')
    op.add_column('task', sa.Column('delete', sa.BOOLEAN(), nullable=True), schema='func')
    op.create_index(op.f('ix_func_task_create_user'), 'task', ['create_user'], unique=False, schema='func')
    op.create_index(op.f('ix_func_task_func_id'), 'task', ['func_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_task_group_id'), 'task', ['group_id'], unique=False, schema='func')
    op.create_index(op.f('ix_func_task_update_user'), 'task', ['update_user'], unique=False, schema='func')
    op.drop_constraint('task_group_id_fkey', 'task', schema='func', type_='foreignkey')
    op.drop_constraint('task_update_user_fkey', 'task', schema='func', type_='foreignkey')
    op.drop_constraint('task_create_user_fkey', 'task', schema='func', type_='foreignkey')
    op.create_foreign_key(None, 'task', 'users', ['create_user'], ['user_id'], source_schema='func', referent_schema='public')
    op.create_foreign_key(None, 'task', 'group', ['group_id'], ['group_id'], source_schema='func', referent_schema='public')
    op.create_foreign_key(None, 'task', 'users', ['update_user'], ['user_id'], source_schema='func', referent_schema='public')
    op.drop_constraint('input_resource_data_user_id_fkey', 'input_resource_data', schema='resource', type_='foreignkey')
    op.create_foreign_key(None, 'input_resource_data', 'users', ['user_id'], ['user_id'], source_schema='resource', referent_schema='public')
    op.drop_constraint('input_resource_info_update_user_id_fkey', 'input_resource_info', schema='resource', type_='foreignkey')
    op.create_foreign_key(None, 'input_resource_info', 'users', ['update_user_id'], ['user_id'], source_schema='resource', referent_schema='public')
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, 'input_resource_info', schema='resource', type_='foreignkey')
    op.create_foreign_key('input_resource_info_update_user_id_fkey', 'input_resource_info', 'users', ['update_user_id'], ['user_id'], source_schema='resource')
    op.drop_constraint(None, 'input_resource_data', schema='resource', type_='foreignkey')
    op.create_foreign_key('input_resource_data_user_id_fkey', 'input_resource_data', 'users', ['user_id'], ['user_id'], source_schema='resource')
    op.drop_constraint(None, 'task', schema='func', type_='foreignkey')
    op.drop_constraint(None, 'task', schema='func', type_='foreignkey')
    op.drop_constraint(None, 'task', schema='func', type_='foreignkey')
    op.create_foreign_key('task_create_user_fkey', 'task', 'users', ['create_user'], ['user_id'], source_schema='func')
    op.create_foreign_key('task_update_user_fkey', 'task', 'users', ['update_user'], ['user_id'], source_schema='func')
    op.create_foreign_key('task_group_id_fkey', 'task', 'group', ['group_id'], ['group_id'], source_schema='func')
    op.drop_index(op.f('ix_func_task_update_user'), table_name='task', schema='func')
    op.drop_index(op.f('ix_func_task_group_id'), table_name='task', schema='func')
    op.drop_index(op.f('ix_func_task_func_id'), table_name='task', schema='func')
    op.drop_index(op.f('ix_func_task_create_user'), table_name='task', schema='func')
    op.drop_column('task', 'delete', schema='func')
    op.drop_constraint(None, 'quotations', schema='func', type_='foreignkey')
    op.drop_constraint(None, 'quotations', schema='func', type_='foreignkey')
    op.create_foreign_key('quotations_create_user_fkey', 'quotations', 'users', ['create_user'], ['user_id'], source_schema='func')
    op.create_foreign_key('quotations_update_user_fkey', 'quotations', 'users', ['update_user'], ['user_id'], source_schema='func')
    op.drop_index(op.f('ix_func_quotations_update_user'), table_name='quotations', schema='func')
    op.drop_index(op.f('ix_func_quotations_status'), table_name='quotations', schema='func')
    op.drop_index(op.f('ix_func_quotations_quotation_ver'), table_name='quotations', schema='func')
    op.drop_index(op.f('ix_func_quotations_proj_id'), table_name='quotations', schema='func')
    op.drop_index(op.f('ix_func_quotations_parent_quotation_id'), table_name='quotations', schema='func')
    op.drop_index(op.f('ix_func_quotations_create_user'), table_name='quotations', schema='func')
    op.drop_column('quotations', 'quotation_ver', schema='func')
    op.drop_constraint(None, 'projects', schema='func', type_='foreignkey')
    op.create_foreign_key('projects_commit_user_fkey', 'projects', 'users', ['commit_user'], ['user_id'], source_schema='func')
    op.drop_index(op.f('ix_func_projects_proj_type'), table_name='projects', schema='func')
    op.drop_index(op.f('ix_func_projects_proj_state'), table_name='projects', schema='func')
    op.drop_index(op.f('ix_func_projects_inside_name'), table_name='projects', schema='func')
    op.drop_index(op.f('ix_func_projects_commit_user'), table_name='projects', schema='func')
    op.drop_index(op.f('ix_func_preconditions_quotation_id'), table_name='preconditions', schema='func')
    op.drop_index(op.f('ix_func_preconditions_proj_id'), table_name='preconditions', schema='func')
    op.drop_index(op.f('ix_func_options_quotation_id'), table_name='options', schema='func')
    op.drop_index(op.f('ix_func_options_proj_id'), table_name='options', schema='func')
    op.drop_index(op.f('ix_func_option_value_option_id'), table_name='option_value', schema='func')
    op.drop_constraint(None, 'functions', schema='func', type_='foreignkey')
    op.drop_constraint(None, 'functions', schema='func', type_='foreignkey')
    op.create_foreign_key('functions_update_user_fkey', 'functions', 'users', ['update_user'], ['user_id'], source_schema='func')
    op.create_foreign_key('functions_create_user_fkey', 'functions', 'users', ['create_user'], ['user_id'], source_schema='func')
    op.drop_index(op.f('ix_func_functions_update_user'), table_name='functions', schema='func')
    op.drop_index(op.f('ix_func_functions_quotation_id'), table_name='functions', schema='func')
    op.drop_index(op.f('ix_func_functions_create_user'), table_name='functions', schema='func')
    op.drop_index(op.f('ix_func_functions_category_id'), table_name='functions', schema='func')
    op.drop_constraint(None, 'func_man_day', schema='func', type_='foreignkey')
    op.drop_constraint(None, 'func_man_day', schema='func', type_='foreignkey')
    op.drop_constraint(None, 'func_man_day', schema='func', type_='foreignkey')
    op.drop_constraint(None, 'func_man_day', schema='func', type_='foreignkey')
    op.create_foreign_key('func_man_day_group_id_fkey', 'func_man_day', 'group', ['group_id'], ['group_id'], source_schema='func')
    op.create_foreign_key('func_man_day_assin_to_fkey', 'func_man_day', 'users', ['assin_to'], ['user_id'], source_schema='func')
    op.create_foreign_key('func_man_day_update_user_fkey', 'func_man_day', 'users', ['update_user'], ['user_id'], source_schema='func')
    op.create_foreign_key('func_man_day_create_user_fkey', 'func_man_day', 'users', ['create_user'], ['user_id'], source_schema='func')
    op.create_index('func_func_man_day_task_id_group_id_idx', 'func_man_day', ['task_id', 'group_id'], unique=False, schema='func')
    op.drop_index('func_func_man_day_task_option_group_version_id_idx', table_name='func_man_day', schema='func')
    op.drop_constraint(None, 'func_group', schema='func', type_='foreignkey')
    op.create_foreign_key('func_group_group_id_fkey', 'func_group', 'group', ['group_id'], ['group_id'], source_schema='func')
    op.drop_constraint(None, 'user_role', schema='public', type_='foreignkey')
    op.drop_constraint(None, 'user_role', schema='public', type_='foreignkey')
    op.drop_constraint(None, 'user_role', schema='public', type_='foreignkey')
    op.drop_constraint(None, 'user_role', schema='public', type_='foreignkey')
    op.create_foreign_key('user_role_proj_id_fkey', 'user_role', 'projects', ['proj_id'], ['proj_id'], referent_schema='func')
    op.create_foreign_key('user_role_group_id_fkey', 'user_role', 'group', ['group_id'], ['group_id'])
    op.create_foreign_key('user_role_role_id_fkey', 'user_role', 'roles', ['role_id'], ['role_id'])
    op.create_foreign_key('user_role_user_id_fkey', 'user_role', 'users', ['user_id'], ['user_id'])
    op.drop_index('public_user_role_project_group_user_id_idx', table_name='user_role', schema='public')
    op.drop_constraint(None, 'role_permission', type_='foreignkey')
    op.drop_constraint(None, 'role_permission', type_='foreignkey')
    op.create_foreign_key('role_permission_role_id_fkey', 'role_permission', 'roles', ['role_id'], ['role_id'])
    op.create_foreign_key('role_permission_perm_id_fkey', 'role_permission', 'permission', ['perm_id'], ['permission_id'])
    op.drop_constraint(None, 'replay', schema='public', type_='foreignkey')
    op.drop_constraint(None, 'replay', schema='public', type_='foreignkey')
    op.create_foreign_key('replay_issue_user_fkey', 'replay', 'users', ['issue_user'], ['user_id'])
    op.create_foreign_key('replay_issue_id_fkey', 'replay', 'issue', ['issue_id'], ['issue_id'])
    op.drop_constraint(None, 'journal_details', schema='public', type_='foreignkey')
    op.create_foreign_key('journal_details_j_brief_id_fkey', 'journal_details', 'journal_briefs', ['j_brief_id'], ['j_brief_id'])
    op.drop_constraint(None, 'journal_briefs', schema='public', type_='foreignkey')
    op.create_foreign_key('journal_briefs_journalized_id_fkey', 'journal_briefs', 'journals', ['journalized_id'], ['journalized_id'])
    op.drop_constraint(None, 'issue', schema='public', type_='foreignkey')
    op.create_foreign_key('issue_issue_user_fkey', 'issue', 'users', ['issue_user'], ['user_id'])
    op.drop_constraint(None, 'group', schema='public', type_='foreignkey')
    op.create_foreign_key('group_owner_user_fkey', 'group', 'users', ['owner_user'], ['user_id'])
    # ### end Alembic commands ###
